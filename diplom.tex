 \documentclass[a4paper,14pt,ukrainian]{extreport}

%\usepackage{extsizes}
%\usepackage{cmap} % для кодировки шрифтов в pdf
%\usepackage[T2A]{fontenc}
%\usepackage[utf8]{inputenc}
\usepackage[ukrainian,english]{babel}


\usepackage{fontspec} % loaded by polyglossia, but included here for transparency 
\usepackage{polyglossia}
\setmainlanguage{ukrainian}
\setotherlanguage{english}
\newfontfamily\ukrainianfont[Script=Cyrillic]{Times New Roman}

\usepackage{kantlipsum} % для водички

\usepackage{graphicx} % для вставки картинок
\usepackage{amssymb,amsfonts,amsmath,amsthm} % математические дополнения от АМС
\usepackage{indentfirst} % отделять первую строку раздела абзацным отступом тоже
\usepackage[usenames,dvipsnames]{color} % названия цветов
\usepackage{makecell}
\usepackage{multirow} % улучшенное форматирование таблиц
%\usepackage{ulem} % подчеркивания

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% КОЛОНТИТУЛЫ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[R]{\thepage}
\fancyheadoffset{0mm}
\fancyfootoffset{0mm}
\setlength{\headheight}{17pt}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancypagestyle{plain}{ 
  \fancyhf{}
  \rhead{\thepage}}
\setcounter{page}{5} % начать нумерацию страниц с №5

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ПОДПИСИ К РИСУНКАМ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage[tableposition=top]{caption}
\usepackage{subcaption}
\DeclareCaptionLabelFormat{gostfigure}{Рисунок #2}
\DeclareCaptionLabelFormat{gosttable}{Таблиця #2}
\DeclareCaptionLabelSeparator{gost}{~—~}
\captionsetup{labelsep=gost}
\captionsetup{%
  format=plain,
  margin={1.25cm,0cm},
  indention=-1.25cm,
  font=doublespacing
}
\captionsetup[figure]{labelformat=gostfigure}
\captionsetup[table]{labelformat=gosttable}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% МЕЛОЧИ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\parindent=1.25cm
\usepackage[doublespacing]{setspace}
%\usepackage[nodisplayskipstretch]{setspace}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ОГЛАВЛЕНИЯ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{titlesec}

\titleformat{\chapter}[display]
{\filcenter}
{\MakeUppercase{\chaptertitlename} \thechapter}
{8pt}
{\bfseries}{}

\titleformat{\section}[block]
{\normalsize\bfseries}
{\thesection}
{1em}{}

\titleformat{\subsection}[block]
{\normalsize\bfseries}
{\thesubsection}
{1em}{}

% Настройка вертикальных и горизонтальных отступов
\titlespacing*{\chapter}{0pt}{-30pt}{8pt}
\titlespacing*{\section}{\parindent}{*4}{*4}
\titlespacing*{\subsection}{\parindent}{*4}{*4}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% LIKECHAPTER
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\newcommand{\empline}{\mbox{}\newline}
\newcommand{\likechapterheading}[1]{ 
  \begin{center}
    \newpage
    \textbf{\MakeUppercase{#1}}
  \end{center}
  \empline}

\makeatletter
\renewcommand{\@dotsep}{2}
\newcommand{\l@likechapter}[2]{{\bfseries\@dottedtocline{0}{0pt}{0pt}{#1}{#2}}}
\makeatother
\newcommand{\likechapter}[1]{    
  \likechapterheading{#1}    
  \addcontentsline{toc}{likechapter}{\MakeUppercase{#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ПРИЛОЖЕНИЯ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage[title,titletoc]{appendix}

\titleformat{\paragraph}[display]
{\filcenter}
{\MakeUppercase{\chaptertitlename} \thechapter}
{8pt}
{\bfseries}{}
\titlespacing*{\paragraph}{0pt}{-30pt}{8pt}

\newcommand{\append}[1]{  
  \clearpage
  \stepcounter{chapter}    
  \paragraph{\MakeUppercase{#1}}
  \empline
  \addcontentsline{toc}{likechapter}{\MakeUppercase{\chaptertitlename~\Asbuk{chapter}\;#1}}}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ЗМІСТ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{tocloft}
\renewcommand{\cfttoctitlefont}{\hspace{0.38\textwidth} \bfseries\MakeUppercase}
\renewcommand{\cftbeforetoctitleskip}{-1em}
\renewcommand{\cftaftertoctitle}{\mbox{}\hfill \\ \mbox{}\hfill{\footnotesize Стор.}\vspace{-2.5em}}
\renewcommand{\cftchapfont}{\normalsize\bfseries \MakeUppercase{\chaptername} }
\renewcommand{\cftsecfont}{\hspace{48pt}} % было 31pt
\renewcommand{\cftsubsecfont}{\hspace{16.5pt}} % было 11pt
\renewcommand{\cftbeforechapskip}{1em}
\renewcommand{\cftparskip}{-1mm}
\renewcommand{\cftdotsep}{1}
\setcounter{tocdepth}{2} % задать глубину оглавления — до subsection включительно

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% ПОЛЯ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{geometry}
\geometry{left=3cm}
\geometry{right=1.5cm}
\geometry{top=2.4cm}
\geometry{bottom=2.4cm}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% СПИСКИ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{enumitem}
\makeatletter
\AddEnumerateCounter{\asbuk}{\@asbuk}{м)}
\makeatother
\setlist{nolistsep}
\renewcommand{\labelitemi}{-}
\renewcommand{\labelenumi}{\asbuk{enumi})}
\renewcommand{\labelenumii}{\arabic{enumii})}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% СПИСОК ЛИТЕРАТУРЫ
%%%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage{gost}
\usepackage[square,numbers,sort&compress]{natbib}
\renewcommand{\bibnumfmt}[1]{#1.\hfill} % нумерация источников в самом списке — через точку
\renewcommand{\bibsection}{\likechapter{Список використаних джерел}} % заголовок специального раздела
\setlength{\bibsep}{0pt}
\bibliographystyle{ugost2003}

%%%%%%%%%%%%%%%%%%%%%%%%%% 
% СЧЕТЧИКИ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\usepackage{lastpage}
\newcounter{totfigures}
\newcounter{tottables}
\makeatletter
\AtEndDocument{%
  \addtocounter{totfigures}{\value{figure}}%
  \addtocounter{tottables}{\value{table}}%
  \immediate\write\@mainaux{%
    \string\gdef\string\totfig{\number\value{totfigures}}%
    \string\gdef\string\tottab{\number\value{tottables}}%    
  }%
}
\makeatother

\usepackage{etoolbox}
\pretocmd{\chapter}{\addtocounter{totfigures}{\value{figure}}}{}{}
\pretocmd{\chapter}{\addtocounter{tottables}{\value{table}}}{}{}
%\pretocmd{\likechapter}{\par}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% ДОКУМЕНТ
%%%%%%%%%%%%%%%%%%%%%%%%%% 
\begin{document}
% \input{title.tex}
\tableofcontents
\setcounter{page}{2}
\input{intro.tex}
\input{main.tex}
\pagebreak
\input{conclusions.tex}
\newpage
\bibliography{lit/my}
%\newpage
%\input{app.tex}

\end{document}
